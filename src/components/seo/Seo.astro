---
import siteData from "../../data/siteData.json";
import jsonLDGenerator from "../../utils/jsonLD";

interface Props {
  title: string;
  description: string;
  url?: URL;
  image?: { src: string; alt: string; type?: string; width?: number; height?: number };
  robots?: boolean;
  frontmatter?: Record<string, unknown>;
}

const {
  title,
  description,
  url = Astro.url,
  image = siteData.image,
  frontmatter,
  robots,
} = Astro.props;

const siteName = import.meta.env.SITE_NAME || "Site Name";
const defaultImage = import.meta.env.DEFAULT_IMAGE || siteData.image.src;

const jsonLD = jsonLDGenerator({
  type: frontmatter ? "post" : "website",
  post: frontmatter,
  url: url.toString(),
});
---

<!-- SEO -->
<link rel="canonical" href={url} />
<meta name="description" content={description} />

<!-- Open Graph -->
<meta property="og:site_name" content={siteName} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:url" content={url} />
<meta property="og:image" content={image.src || defaultImage} />
<meta property="og:image:url" content={image.src || defaultImage} />
<meta property="og:image:secure_url" content={image.src || defaultImage} />
<meta property="og:image:type" content={image.type || "image/jpeg"} />
<meta property="og:image:width" content={image.width?.toString() || "1200"} />
<meta property="og:image:height" content={image.height?.toString() || "630"} />
<meta property="og:image:alt" content={image.alt || title} />

<!-- Twitter -->
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content={image.src || defaultImage} />
<meta name="twitter:image:alt" content={image.alt || title} />
<meta name="twitter:domain" content={import.meta.env.SITE} />

{robots && <meta name="robots" content="noindex, nofollow" />}

<!-- JSON LD -->
<Fragment set:html={jsonLD} />

<!-- Additional SEO tags -->
<meta name="author" content={siteName} />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="generator" content={Astro.generator} />
